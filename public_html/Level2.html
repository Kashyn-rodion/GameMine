<!doctype html> 
<html>
<meta charset='utf-8'>
  <head>
	<title>Game</title>
	<link href="css/style.css" type="text/css" rel="stylesheet">
  </head>
    <body id = "fon" align = 'center'>
    <canvas id='example'>Обновите браузер</canvas>
	<div><canvas id='menu_canv'>Обновите браузер</canvas></div>
	<script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
	<script src="js/ImgProc.js"></script>
	<script src="js/menu.js"></script>
        <script src="js/GameFunc.js"></script>
        <script src="js/DrawInfo.js"></script>
    <script>
                //блокирование скролинга
                document.body.addEventListener('touchmove',function(event) {event.preventDefault();},false);
    var status=0;//0 - game, 1 - lose, 2 - win;            
    var infoimage= new CStat();
                var CellSize = 50;	
                var Game=null;
	        var targetRate = 200;
             //   Game=LoadState();
                if(Game==null)
                {
		var Map = new CMap(10,10);
Map.blocs = [[1 ,2 ,4 ,1 ,1 ,1 ,1 ,1 ,2 ,4 ],[1 ,2 ,3 ,2 ,2 ,2 ,1 ,1 ,2 ,1 ],[1 ,2 ,2 ,2 ,3 ,2 ,1 ,1 ,2 ,1 ],[1 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,2 ,1 ],[1 ,2 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ],[1 ,2 ,1 ,0 ,0 ,4 ,1 ,2 ,1 ,3 ],[1 ,2 ,1 ,1 ,2 ,1 ,1 ,2 ,2 ,2 ],[1 ,2 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ],[1 ,2 ,0 ,0 ,0 ,0 ,1 ,2 ,0 ,1 ],[4 ,3 ,0 ,3 ,1 ,1 ,1 ,2 ,1 ,5 ]];

		var Player = new CPlayer(0,0);
		//var targetX=Player.x, targetY=Player.y;
                Game = new CGameInfo(Player,Map);
              
    
     }
     
         var targetX=Game.Player.x, targetY=Game.Player.y;
              
var example = document.getElementById('example');
var m_canv = document.getElementById('menu_canv');
var menu = new CMenu();
//DrawMap(Map,example,Player);
//DrawPlayer(Player,50,example);
var wait=0;
tID = setInterval(function(){PaintFrame(CellSize, Game);}, 400);
		
		//DrawMap(Map,example);
		//DrawPlayer(Player,50,example);
     
    $(document.example).on("touchend", function(e) {
       e.changedTouches[0].pageX;
       var x = offset.left;
       var y = offset.top;
       targetX = parseInt((e.changedTouches[0].pageX-x)/CellSize);
       targetY = parseInt((e.changedTouches[0].pageY-y)/CellSize);
        });
      
      $('#example').click(function(eventObject)
		{
			var offset = jQuery('#example').offset();
			var x = offset.left;
			var y = offset.top;
			targetX = parseInt((eventObject.pageX-x)/CellSize);
			targetY = parseInt((eventObject.pageY-y)/CellSize);
		});
      $(document.menu_canv).on("touchend", function(e) {
                        var offset = jQuery('#example').offset();
			var x = offset.left;
			var y = offset.top;
			OnClic((e.changedTouches[0].pageX-x), (e.changedTouches[0].pageY-y),menu);
        });
	$('#menu_canv').click(function(eventObject)
		{
			var offset = jQuery('#example').offset();
			var x = offset.left;
			var y = offset.top;
			
                        OnClic((eventObject.pageX-x), (eventObject.pageY-y),menu,Game);
		});
			
    </script>
  </body>
</html>